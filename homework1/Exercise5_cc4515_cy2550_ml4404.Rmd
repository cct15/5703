---
title: "Exercise5"
author: Chutian Chen cc4515; Congcheng Yan cy2550; Mingrui Liu ml4404
output: pdf_document
---

## (4)
MLE: $\sum_{i=1}^{n}(-\mu+x_iln(\mu)-ln(x_i!))$

```{r}
library(ggplot2)
freq <- c(179,51,17,6,8,1,0,2)
y <- seq(2,9,1)
data <- as.data.frame(y)
data$freq <- freq
log_mle <- function(miu) {
  likehood <- function(miu,y) {
    return(-miu+y*log(miu)-log(factorial(y))-log(1-exp(-miu)-miu*exp(-miu)))
  }
  return(sum(likehood(miu,data$y)*data$freq))
}
miu <- seq(0.8,1.6,0.1)
mle <- sapply(miu,log_mle)
ggplot() + geom_line(aes(x = miu, y = mle))
```

## (5)
```{r}
library(optim.functions)
initial <- c(1)
optim(initial, a <- function(x){return(-log_mle(x))}, method = "BFGS")
```

We use BFGS. The MLE of $\mu$ is 1.398.


